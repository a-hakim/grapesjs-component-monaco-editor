{"version":3,"sources":["webpack://grapesjs-component-monaco-editor/webpack/universalModuleDefinition","webpack://grapesjs-component-monaco-editor/webpack/bootstrap","webpack://grapesjs-component-monaco-editor/./node_modules/@babel/runtime/helpers/defineProperty.js","webpack://grapesjs-component-monaco-editor/./node_modules/@babel/runtime/helpers/classCallCheck.js","webpack://grapesjs-component-monaco-editor/./node_modules/@babel/runtime/helpers/createClass.js","webpack://grapesjs-component-monaco-editor/./node_modules/split.js/dist/split.es.js","webpack://grapesjs-component-monaco-editor/./src/code-editor/index.js","webpack://grapesjs-component-monaco-editor/./src/commands.js","webpack://grapesjs-component-monaco-editor/./src/consts.js","webpack://grapesjs-component-monaco-editor/./src/index.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","obj","configurable","writable","instance","Constructor","TypeError","_defineProperties","target","props","length","descriptor","protoProps","staticProps","global","ssr","undefined","document","NOOP","calc","filter","prefix","el","createElement","style","cssText","shift","isString","v","String","elementOrSelector","ele","querySelector","Error","getOption","options","propName","def","getGutterSize","gutterSize","isFirst","isLast","gutterAlign","defaultGutterFn","gutterDirection","gut","className","defaultElementStyleFn","dim","size","gutSize","defaultGutterStyleFn","idsOption","dimension","clientAxis","position","positionEnd","clientSize","elements","ids","Array","from","parent","parentNode","parentStyle","getComputedStyle","parentFlexDirection","flexDirection","sizes","map","minSize","minSizes","isArray","expandToMin","snapOffset","dragInterval","direction","cursor","gutter","elementStyle","gutterStyle","setElementSize","keys","forEach","prop","getSizes","element","getMousePosition","e","touches","adjust","offset","a","this","b","percentage","drag","dragging","start","dragOffset","Math","round","calculateSizes","aBounds","bBounds","end","trimToMin","sizesToTrim","parentSize","computedStyle","parseFloat","paddingLeft","paddingRight","paddingTop","paddingBottom","innerSize","reduce","excessPixels","toSpare","pixelSizes","pixelSize","elementGutterSize","elementMinSize","push","newPixelSize","takenPixels","min","stopDragging","stop","move","userSelect","webkitUserSelect","MozUserSelect","pointerEvents","body","startDragging","button","preventDefault","pairs","adjustToMin","pair","id","temp","gutterElement","setGutterSize","insertBefore","computedSize","setSizes","newSizes","trimmed","newSize","collapse","destroy","preserveStyles","preserveGutter","removeChild","CodeEditor","editor","opts","$","pfx","getConfig","canvas","findWithinEditor","panelViews","appendTo","panelId","isShowing","monacoInstances","monacoReady","loadMonaco","pn","Panels","getPanel","addPanel","selector","getEl","monaco","Promise","resolve","monacoLoading","reject","checkMonaco","configureMonaco","setTimeout","script","src","onload","require","config","console","error","contexts","_","paths","vs","onerror","head","appendChild","languages","html","htmlDefaults","setOptions","format","tabSize","insertSpaces","wrapLineLength","unformatted","contentUnformatted","indentInnerHtml","preserveNewLines","maxPreserveNewLines","indentHandlebars","endWithNewline","extraLiners","wrapAttributes","css","cssDefaults","newlineBetweenSelectors","newlineBetweenRules","spaceAroundSelectorSeparator","braceStyle","type","containerId","Date","now","random","toString","substr","container","width","height","editorWrapper","getElement","setContent","content","setValue","formatCodeAutomatically","pendingContent","getContent","getValue","refresh","layout","dispose","innerHTML","editorWrappers","log","monacoEditor","language","theme","automaticLayout","minimap","enabled","scrollBeyondLastLine","fontSize","lineNumbers","roundedSelection","scrollbar","vertical","horizontal","wordWrap","formatOnType","formatOnPaste","codeViewOptions","addAction","label","keybindings","KeyMod","CtrlCmd","Shift","KeyCode","KeyF","run","trim","createTextareaFallback","textarea","background","color","border","fontFamily","resize","outline","codeViewer","section","btnText","htmlBtnText","cssBtnText","cleanCssBtn","cleanCssBtnText","append","codeViewerEl","codePanel","panel","findPanel","addClass","htmlCodeEditor","buildCodeEditor","cssCodeEditor","sections","buildSection","set","trigger","find","on","updateHtml","updateCss","deleteSelectedCss","Split","onDragEnd","refreshEditors","model","updateEditorContents","preserveWidth","openState","cv","initializeMonacoEditorsWhenReady","initializeMonacoEditors","then","catch","fallbackToTextarea","wrapper","parentElement","createMonacoEditor","closedState","action","getAction","warn","fallbackFormat","formattedContent","formatHtml","formatCss","replace","split","line","index","array","indent","prevLine","openTags","match","closeTags","startsWith","max","repeat","join","formatted","component","htmlCode","previousHtmlCode","idStyles","Boolean","cssObjectRule","test","rule","attributes","setComponents","select","replaceWith","cssCode","previousCssCode","Css","addRules","selection","getSelection","isEmpty","selectedText","getModel","getValueInRange","parseRemove","executeEdits","range","text","removeCss","remove","getRules","Parser","parseCss","rules","sm","Selectors","selectors","state","selectorsAdd","atRuleType","atRuleParams","atRule","getSelected","htmlContent","getComponentHtml","cssContent","CodeManager","getCode","cssc","result","componentEl","clearData","classList","toHTML","outerHTML","add","js","editJs","getScriptString","values","cm","Commands","codeEditor","buildCodePanel","showCodePanel","hideCodePanel","commands"],"mappings":"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","file":"grapesjs-component-monaco-editor.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"grapesjs-component-monaco-editor\"] = factory();\n\telse\n\t\troot[\"grapesjs-component-monaco-editor\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","// The programming goals of Split.js are to deliver readable, understandable and\n// maintainable code, while at the same time manually optimizing for tiny minified file size,\n// browser compatibility without additional requirements\n// and very few assumptions about the user's page layout.\nvar global = typeof window !== 'undefined' ? window : null;\nvar ssr = global === null;\nvar document = !ssr ? global.document : undefined;\n\n// Save a couple long function names that are used frequently.\n// This optimization saves around 400 bytes.\nvar addEventListener = 'addEventListener';\nvar removeEventListener = 'removeEventListener';\nvar getBoundingClientRect = 'getBoundingClientRect';\nvar gutterStartDragging = '_a';\nvar aGutterSize = '_b';\nvar bGutterSize = '_c';\nvar HORIZONTAL = 'horizontal';\nvar NOOP = function () { return false; };\n\n// Helper function determines which prefixes of CSS calc we need.\n// We only need to do this once on startup, when this anonymous function is called.\n//\n// Tests -webkit, -moz and -o prefixes. Modified from StackOverflow:\n// http://stackoverflow.com/questions/16625140/js-feature-detection-to-detect-the-usage-of-webkit-calc-over-calc/16625167#16625167\nvar calc = ssr\n    ? 'calc'\n    : ((['', '-webkit-', '-moz-', '-o-']\n          .filter(function (prefix) {\n              var el = document.createElement('div');\n              el.style.cssText = \"width:\" + prefix + \"calc(9px)\";\n\n              return !!el.style.length\n          })\n          .shift()) + \"calc\");\n\n// Helper function checks if its argument is a string-like type\nvar isString = function (v) { return typeof v === 'string' || v instanceof String; };\n\n// Helper function allows elements and string selectors to be used\n// interchangeably. In either case an element is returned. This allows us to\n// do `Split([elem1, elem2])` as well as `Split(['#id1', '#id2'])`.\nvar elementOrSelector = function (el) {\n    if (isString(el)) {\n        var ele = document.querySelector(el);\n        if (!ele) {\n            throw new Error((\"Selector \" + el + \" did not match a DOM element\"))\n        }\n        return ele\n    }\n\n    return el\n};\n\n// Helper function gets a property from the properties object, with a default fallback\nvar getOption = function (options, propName, def) {\n    var value = options[propName];\n    if (value !== undefined) {\n        return value\n    }\n    return def\n};\n\nvar getGutterSize = function (gutterSize, isFirst, isLast, gutterAlign) {\n    if (isFirst) {\n        if (gutterAlign === 'end') {\n            return 0\n        }\n        if (gutterAlign === 'center') {\n            return gutterSize / 2\n        }\n    } else if (isLast) {\n        if (gutterAlign === 'start') {\n            return 0\n        }\n        if (gutterAlign === 'center') {\n            return gutterSize / 2\n        }\n    }\n\n    return gutterSize\n};\n\n// Default options\nvar defaultGutterFn = function (i, gutterDirection) {\n    var gut = document.createElement('div');\n    gut.className = \"gutter gutter-\" + gutterDirection;\n    return gut\n};\n\nvar defaultElementStyleFn = function (dim, size, gutSize) {\n    var style = {};\n\n    if (!isString(size)) {\n        style[dim] = calc + \"(\" + size + \"% - \" + gutSize + \"px)\";\n    } else {\n        style[dim] = size;\n    }\n\n    return style\n};\n\nvar defaultGutterStyleFn = function (dim, gutSize) {\n    var obj;\n\n    return (( obj = {}, obj[dim] = (gutSize + \"px\"), obj ));\n};\n\n// The main function to initialize a split. Split.js thinks about each pair\n// of elements as an independant pair. Dragging the gutter between two elements\n// only changes the dimensions of elements in that pair. This is key to understanding\n// how the following functions operate, since each function is bound to a pair.\n//\n// A pair object is shaped like this:\n//\n// {\n//     a: DOM element,\n//     b: DOM element,\n//     aMin: Number,\n//     bMin: Number,\n//     dragging: Boolean,\n//     parent: DOM element,\n//     direction: 'horizontal' | 'vertical'\n// }\n//\n// The basic sequence:\n//\n// 1. Set defaults to something sane. `options` doesn't have to be passed at all.\n// 2. Initialize a bunch of strings based on the direction we're splitting.\n//    A lot of the behavior in the rest of the library is paramatized down to\n//    rely on CSS strings and classes.\n// 3. Define the dragging helper functions, and a few helpers to go with them.\n// 4. Loop through the elements while pairing them off. Every pair gets an\n//    `pair` object and a gutter.\n// 5. Actually size the pair elements, insert gutters and attach event listeners.\nvar Split = function (idsOption, options) {\n    if ( options === void 0 ) options = {};\n\n    if (ssr) { return {} }\n\n    var ids = idsOption;\n    var dimension;\n    var clientAxis;\n    var position;\n    var positionEnd;\n    var clientSize;\n    var elements;\n\n    // Allow HTMLCollection to be used as an argument when supported\n    if (Array.from) {\n        ids = Array.from(ids);\n    }\n\n    // All DOM elements in the split should have a common parent. We can grab\n    // the first elements parent and hope users read the docs because the\n    // behavior will be whacky otherwise.\n    var firstElement = elementOrSelector(ids[0]);\n    var parent = firstElement.parentNode;\n    var parentStyle = getComputedStyle ? getComputedStyle(parent) : null;\n    var parentFlexDirection = parentStyle ? parentStyle.flexDirection : null;\n\n    // Set default options.sizes to equal percentages of the parent element.\n    var sizes = getOption(options, 'sizes') || ids.map(function () { return 100 / ids.length; });\n\n    // Standardize minSize to an array if it isn't already. This allows minSize\n    // to be passed as a number.\n    var minSize = getOption(options, 'minSize', 100);\n    var minSizes = Array.isArray(minSize) ? minSize : ids.map(function () { return minSize; });\n\n    // Get other options\n    var expandToMin = getOption(options, 'expandToMin', false);\n    var gutterSize = getOption(options, 'gutterSize', 10);\n    var gutterAlign = getOption(options, 'gutterAlign', 'center');\n    var snapOffset = getOption(options, 'snapOffset', 30);\n    var dragInterval = getOption(options, 'dragInterval', 1);\n    var direction = getOption(options, 'direction', HORIZONTAL);\n    var cursor = getOption(\n        options,\n        'cursor',\n        direction === HORIZONTAL ? 'col-resize' : 'row-resize'\n    );\n    var gutter = getOption(options, 'gutter', defaultGutterFn);\n    var elementStyle = getOption(\n        options,\n        'elementStyle',\n        defaultElementStyleFn\n    );\n    var gutterStyle = getOption(options, 'gutterStyle', defaultGutterStyleFn);\n\n    // 2. Initialize a bunch of strings based on the direction we're splitting.\n    // A lot of the behavior in the rest of the library is paramatized down to\n    // rely on CSS strings and classes.\n    if (direction === HORIZONTAL) {\n        dimension = 'width';\n        clientAxis = 'clientX';\n        position = 'left';\n        positionEnd = 'right';\n        clientSize = 'clientWidth';\n    } else if (direction === 'vertical') {\n        dimension = 'height';\n        clientAxis = 'clientY';\n        position = 'top';\n        positionEnd = 'bottom';\n        clientSize = 'clientHeight';\n    }\n\n    // 3. Define the dragging helper functions, and a few helpers to go with them.\n    // Each helper is bound to a pair object that contains its metadata. This\n    // also makes it easy to store references to listeners that that will be\n    // added and removed.\n    //\n    // Even though there are no other functions contained in them, aliasing\n    // this to self saves 50 bytes or so since it's used so frequently.\n    //\n    // The pair object saves metadata like dragging state, position and\n    // event listener references.\n\n    function setElementSize(el, size, gutSize, i) {\n        // Split.js allows setting sizes via numbers (ideally), or if you must,\n        // by string, like '300px'. This is less than ideal, because it breaks\n        // the fluid layout that `calc(% - px)` provides. You're on your own if you do that,\n        // make sure you calculate the gutter size by hand.\n        var style = elementStyle(dimension, size, gutSize, i);\n\n        Object.keys(style).forEach(function (prop) {\n            // eslint-disable-next-line no-param-reassign\n            el.style[prop] = style[prop];\n        });\n    }\n\n    function setGutterSize(gutterElement, gutSize, i) {\n        var style = gutterStyle(dimension, gutSize, i);\n\n        Object.keys(style).forEach(function (prop) {\n            // eslint-disable-next-line no-param-reassign\n            gutterElement.style[prop] = style[prop];\n        });\n    }\n\n    function getSizes() {\n        return elements.map(function (element) { return element.size; })\n    }\n\n    // Supports touch events, but not multitouch, so only the first\n    // finger `touches[0]` is counted.\n    function getMousePosition(e) {\n        if ('touches' in e) { return e.touches[0][clientAxis] }\n        return e[clientAxis]\n    }\n\n    // Actually adjust the size of elements `a` and `b` to `offset` while dragging.\n    // calc is used to allow calc(percentage + gutterpx) on the whole split instance,\n    // which allows the viewport to be resized without additional logic.\n    // Element a's size is the same as offset. b's size is total size - a size.\n    // Both sizes are calculated from the initial parent percentage,\n    // then the gutter size is subtracted.\n    function adjust(offset) {\n        var a = elements[this.a];\n        var b = elements[this.b];\n        var percentage = a.size + b.size;\n\n        a.size = (offset / this.size) * percentage;\n        b.size = percentage - (offset / this.size) * percentage;\n\n        setElementSize(a.element, a.size, this[aGutterSize], a.i);\n        setElementSize(b.element, b.size, this[bGutterSize], b.i);\n    }\n\n    // drag, where all the magic happens. The logic is really quite simple:\n    //\n    // 1. Ignore if the pair is not dragging.\n    // 2. Get the offset of the event.\n    // 3. Snap offset to min if within snappable range (within min + snapOffset).\n    // 4. Actually adjust each element in the pair to offset.\n    //\n    // ---------------------------------------------------------------------\n    // |    | <- a.minSize               ||              b.minSize -> |    |\n    // |    |  | <- this.snapOffset      ||     this.snapOffset -> |  |    |\n    // |    |  |                         ||                        |  |    |\n    // |    |  |                         ||                        |  |    |\n    // ---------------------------------------------------------------------\n    // | <- this.start                                        this.size -> |\n    function drag(e) {\n        var offset;\n        var a = elements[this.a];\n        var b = elements[this.b];\n\n        if (!this.dragging) { return }\n\n        // Get the offset of the event from the first side of the\n        // pair `this.start`. Then offset by the initial position of the\n        // mouse compared to the gutter size.\n        offset =\n            getMousePosition(e) -\n            this.start +\n            (this[aGutterSize] - this.dragOffset);\n\n        if (dragInterval > 1) {\n            offset = Math.round(offset / dragInterval) * dragInterval;\n        }\n\n        // If within snapOffset of min or max, set offset to min or max.\n        // snapOffset buffers a.minSize and b.minSize, so logic is opposite for both.\n        // Include the appropriate gutter sizes to prevent overflows.\n        if (offset <= a.minSize + snapOffset + this[aGutterSize]) {\n            offset = a.minSize + this[aGutterSize];\n        } else if (\n            offset >=\n            this.size - (b.minSize + snapOffset + this[bGutterSize])\n        ) {\n            offset = this.size - (b.minSize + this[bGutterSize]);\n        }\n\n        // Actually adjust the size.\n        adjust.call(this, offset);\n\n        // Call the drag callback continously. Don't do anything too intensive\n        // in this callback.\n        getOption(options, 'onDrag', NOOP)(getSizes());\n    }\n\n    // Cache some important sizes when drag starts, so we don't have to do that\n    // continously:\n    //\n    // `size`: The total size of the pair. First + second + first gutter + second gutter.\n    // `start`: The leading side of the first element.\n    //\n    // ------------------------------------------------\n    // |      aGutterSize -> |||                      |\n    // |                     |||                      |\n    // |                     |||                      |\n    // |                     ||| <- bGutterSize       |\n    // ------------------------------------------------\n    // | <- start                             size -> |\n    function calculateSizes() {\n        // Figure out the parent size minus padding.\n        var a = elements[this.a].element;\n        var b = elements[this.b].element;\n\n        var aBounds = a[getBoundingClientRect]();\n        var bBounds = b[getBoundingClientRect]();\n\n        this.size =\n            aBounds[dimension] +\n            bBounds[dimension] +\n            this[aGutterSize] +\n            this[bGutterSize];\n        this.start = aBounds[position];\n        this.end = aBounds[positionEnd];\n    }\n\n    function innerSize(element) {\n        // Return nothing if getComputedStyle is not supported (< IE9)\n        // Or if parent element has no layout yet\n        if (!getComputedStyle) { return null }\n\n        var computedStyle = getComputedStyle(element);\n\n        if (!computedStyle) { return null }\n\n        var size = element[clientSize];\n\n        if (size === 0) { return null }\n\n        if (direction === HORIZONTAL) {\n            size -=\n                parseFloat(computedStyle.paddingLeft) +\n                parseFloat(computedStyle.paddingRight);\n        } else {\n            size -=\n                parseFloat(computedStyle.paddingTop) +\n                parseFloat(computedStyle.paddingBottom);\n        }\n\n        return size\n    }\n\n    // When specifying percentage sizes that are less than the computed\n    // size of the element minus the gutter, the lesser percentages must be increased\n    // (and decreased from the other elements) to make space for the pixels\n    // subtracted by the gutters.\n    function trimToMin(sizesToTrim) {\n        // Try to get inner size of parent element.\n        // If it's no supported, return original sizes.\n        var parentSize = innerSize(parent);\n        if (parentSize === null) {\n            return sizesToTrim\n        }\n\n        if (minSizes.reduce(function (a, b) { return a + b; }, 0) > parentSize) {\n            return sizesToTrim\n        }\n\n        // Keep track of the excess pixels, the amount of pixels over the desired percentage\n        // Also keep track of the elements with pixels to spare, to decrease after if needed\n        var excessPixels = 0;\n        var toSpare = [];\n\n        var pixelSizes = sizesToTrim.map(function (size, i) {\n            // Convert requested percentages to pixel sizes\n            var pixelSize = (parentSize * size) / 100;\n            var elementGutterSize = getGutterSize(\n                gutterSize,\n                i === 0,\n                i === sizesToTrim.length - 1,\n                gutterAlign\n            );\n            var elementMinSize = minSizes[i] + elementGutterSize;\n\n            // If element is too smal, increase excess pixels by the difference\n            // and mark that it has no pixels to spare\n            if (pixelSize < elementMinSize) {\n                excessPixels += elementMinSize - pixelSize;\n                toSpare.push(0);\n                return elementMinSize\n            }\n\n            // Otherwise, mark the pixels it has to spare and return it's original size\n            toSpare.push(pixelSize - elementMinSize);\n            return pixelSize\n        });\n\n        // If nothing was adjusted, return the original sizes\n        if (excessPixels === 0) {\n            return sizesToTrim\n        }\n\n        return pixelSizes.map(function (pixelSize, i) {\n            var newPixelSize = pixelSize;\n\n            // While there's still pixels to take, and there's enough pixels to spare,\n            // take as many as possible up to the total excess pixels\n            if (excessPixels > 0 && toSpare[i] - excessPixels > 0) {\n                var takenPixels = Math.min(\n                    excessPixels,\n                    toSpare[i] - excessPixels\n                );\n\n                // Subtract the amount taken for the next iteration\n                excessPixels -= takenPixels;\n                newPixelSize = pixelSize - takenPixels;\n            }\n\n            // Return the pixel size adjusted as a percentage\n            return (newPixelSize / parentSize) * 100\n        })\n    }\n\n    // stopDragging is very similar to startDragging in reverse.\n    function stopDragging() {\n        var self = this;\n        var a = elements[self.a].element;\n        var b = elements[self.b].element;\n\n        if (self.dragging) {\n            getOption(options, 'onDragEnd', NOOP)(getSizes());\n        }\n\n        self.dragging = false;\n\n        // Remove the stored event listeners. This is why we store them.\n        global[removeEventListener]('mouseup', self.stop);\n        global[removeEventListener]('touchend', self.stop);\n        global[removeEventListener]('touchcancel', self.stop);\n        global[removeEventListener]('mousemove', self.move);\n        global[removeEventListener]('touchmove', self.move);\n\n        // Clear bound function references\n        self.stop = null;\n        self.move = null;\n\n        a[removeEventListener]('selectstart', NOOP);\n        a[removeEventListener]('dragstart', NOOP);\n        b[removeEventListener]('selectstart', NOOP);\n        b[removeEventListener]('dragstart', NOOP);\n\n        a.style.userSelect = '';\n        a.style.webkitUserSelect = '';\n        a.style.MozUserSelect = '';\n        a.style.pointerEvents = '';\n\n        b.style.userSelect = '';\n        b.style.webkitUserSelect = '';\n        b.style.MozUserSelect = '';\n        b.style.pointerEvents = '';\n\n        self.gutter.style.cursor = '';\n        self.parent.style.cursor = '';\n        document.body.style.cursor = '';\n    }\n\n    // startDragging calls `calculateSizes` to store the inital size in the pair object.\n    // It also adds event listeners for mouse/touch events,\n    // and prevents selection while dragging so avoid the selecting text.\n    function startDragging(e) {\n        // Right-clicking can't start dragging.\n        if ('button' in e && e.button !== 0) {\n            return\n        }\n\n        // Alias frequently used variables to save space. 200 bytes.\n        var self = this;\n        var a = elements[self.a].element;\n        var b = elements[self.b].element;\n\n        // Call the onDragStart callback.\n        if (!self.dragging) {\n            getOption(options, 'onDragStart', NOOP)(getSizes());\n        }\n\n        // Don't actually drag the element. We emulate that in the drag function.\n        e.preventDefault();\n\n        // Set the dragging property of the pair object.\n        self.dragging = true;\n\n        // Create two event listeners bound to the same pair object and store\n        // them in the pair object.\n        self.move = drag.bind(self);\n        self.stop = stopDragging.bind(self);\n\n        // All the binding. `window` gets the stop events in case we drag out of the elements.\n        global[addEventListener]('mouseup', self.stop);\n        global[addEventListener]('touchend', self.stop);\n        global[addEventListener]('touchcancel', self.stop);\n        global[addEventListener]('mousemove', self.move);\n        global[addEventListener]('touchmove', self.move);\n\n        // Disable selection. Disable!\n        a[addEventListener]('selectstart', NOOP);\n        a[addEventListener]('dragstart', NOOP);\n        b[addEventListener]('selectstart', NOOP);\n        b[addEventListener]('dragstart', NOOP);\n\n        a.style.userSelect = 'none';\n        a.style.webkitUserSelect = 'none';\n        a.style.MozUserSelect = 'none';\n        a.style.pointerEvents = 'none';\n\n        b.style.userSelect = 'none';\n        b.style.webkitUserSelect = 'none';\n        b.style.MozUserSelect = 'none';\n        b.style.pointerEvents = 'none';\n\n        // Set the cursor at multiple levels\n        self.gutter.style.cursor = cursor;\n        self.parent.style.cursor = cursor;\n        document.body.style.cursor = cursor;\n\n        // Cache the initial sizes of the pair.\n        calculateSizes.call(self);\n\n        // Determine the position of the mouse compared to the gutter\n        self.dragOffset = getMousePosition(e) - self.end;\n    }\n\n    // adjust sizes to ensure percentage is within min size and gutter.\n    sizes = trimToMin(sizes);\n\n    // 5. Create pair and element objects. Each pair has an index reference to\n    // elements `a` and `b` of the pair (first and second elements).\n    // Loop through the elements while pairing them off. Every pair gets a\n    // `pair` object and a gutter.\n    //\n    // Basic logic:\n    //\n    // - Starting with the second element `i > 0`, create `pair` objects with\n    //   `a = i - 1` and `b = i`\n    // - Set gutter sizes based on the _pair_ being first/last. The first and last\n    //   pair have gutterSize / 2, since they only have one half gutter, and not two.\n    // - Create gutter elements and add event listeners.\n    // - Set the size of the elements, minus the gutter sizes.\n    //\n    // -----------------------------------------------------------------------\n    // |     i=0     |         i=1         |        i=2       |      i=3     |\n    // |             |                     |                  |              |\n    // |           pair 0                pair 1             pair 2           |\n    // |             |                     |                  |              |\n    // -----------------------------------------------------------------------\n    var pairs = [];\n    elements = ids.map(function (id, i) {\n        // Create the element object.\n        var element = {\n            element: elementOrSelector(id),\n            size: sizes[i],\n            minSize: minSizes[i],\n            i: i,\n        };\n\n        var pair;\n\n        if (i > 0) {\n            // Create the pair object with its metadata.\n            pair = {\n                a: i - 1,\n                b: i,\n                dragging: false,\n                direction: direction,\n                parent: parent,\n            };\n\n            pair[aGutterSize] = getGutterSize(\n                gutterSize,\n                i - 1 === 0,\n                false,\n                gutterAlign\n            );\n            pair[bGutterSize] = getGutterSize(\n                gutterSize,\n                false,\n                i === ids.length - 1,\n                gutterAlign\n            );\n\n            // if the parent has a reverse flex-direction, switch the pair elements.\n            if (\n                parentFlexDirection === 'row-reverse' ||\n                parentFlexDirection === 'column-reverse'\n            ) {\n                var temp = pair.a;\n                pair.a = pair.b;\n                pair.b = temp;\n            }\n        }\n\n        // Determine the size of the current element. IE8 is supported by\n        // staticly assigning sizes without draggable gutters. Assigns a string\n        // to `size`.\n        //\n        // Create gutter elements for each pair.\n        if (i > 0) {\n            var gutterElement = gutter(i, direction, element.element);\n            setGutterSize(gutterElement, gutterSize, i);\n\n            // Save bound event listener for removal later\n            pair[gutterStartDragging] = startDragging.bind(pair);\n\n            // Attach bound event listener\n            gutterElement[addEventListener](\n                'mousedown',\n                pair[gutterStartDragging]\n            );\n            gutterElement[addEventListener](\n                'touchstart',\n                pair[gutterStartDragging]\n            );\n\n            parent.insertBefore(gutterElement, element.element);\n\n            pair.gutter = gutterElement;\n        }\n\n        setElementSize(\n            element.element,\n            element.size,\n            getGutterSize(\n                gutterSize,\n                i === 0,\n                i === ids.length - 1,\n                gutterAlign\n            ),\n            i\n        );\n\n        // After the first iteration, and we have a pair object, append it to the\n        // list of pairs.\n        if (i > 0) {\n            pairs.push(pair);\n        }\n\n        return element\n    });\n\n    function adjustToMin(element) {\n        var isLast = element.i === pairs.length;\n        var pair = isLast ? pairs[element.i - 1] : pairs[element.i];\n\n        calculateSizes.call(pair);\n\n        var size = isLast\n            ? pair.size - element.minSize - pair[bGutterSize]\n            : element.minSize + pair[aGutterSize];\n\n        adjust.call(pair, size);\n    }\n\n    elements.forEach(function (element) {\n        var computedSize = element.element[getBoundingClientRect]()[dimension];\n\n        if (computedSize < element.minSize) {\n            if (expandToMin) {\n                adjustToMin(element);\n            } else {\n                // eslint-disable-next-line no-param-reassign\n                element.minSize = computedSize;\n            }\n        }\n    });\n\n    function setSizes(newSizes) {\n        var trimmed = trimToMin(newSizes);\n        trimmed.forEach(function (newSize, i) {\n            if (i > 0) {\n                var pair = pairs[i - 1];\n\n                var a = elements[pair.a];\n                var b = elements[pair.b];\n\n                a.size = trimmed[i - 1];\n                b.size = newSize;\n\n                setElementSize(a.element, a.size, pair[aGutterSize], a.i);\n                setElementSize(b.element, b.size, pair[bGutterSize], b.i);\n            }\n        });\n    }\n\n    function destroy(preserveStyles, preserveGutter) {\n        pairs.forEach(function (pair) {\n            if (preserveGutter !== true) {\n                pair.parent.removeChild(pair.gutter);\n            } else {\n                pair.gutter[removeEventListener](\n                    'mousedown',\n                    pair[gutterStartDragging]\n                );\n                pair.gutter[removeEventListener](\n                    'touchstart',\n                    pair[gutterStartDragging]\n                );\n            }\n\n            if (preserveStyles !== true) {\n                var style = elementStyle(\n                    dimension,\n                    pair.a.size,\n                    pair[aGutterSize]\n                );\n\n                Object.keys(style).forEach(function (prop) {\n                    elements[pair.a].element.style[prop] = '';\n                    elements[pair.b].element.style[prop] = '';\n                });\n            }\n        });\n    }\n\n    return {\n        setSizes: setSizes,\n        getSizes: getSizes,\n        collapse: function collapse(i) {\n            adjustToMin(elements[i]);\n        },\n        destroy: destroy,\n        parent: parent,\n        pairs: pairs,\n    }\n};\n\nexport default Split;\n","//Original work Copyright (c) 2018, Duarte Henriques, https://github.com/portablemind/grapesjs-code-editor\r\n//Modified work Copyright (c) 2020, Brendon Ngirazi, https://github.com/Ju99ernaut/grapesjs-component-code-editor\r\n//Modified work Copyright (c) 2025, A.Hakim, https://github.com/a-hakim/grapesjs-component-monaco-editor\r\n//All rights reserved.\r\n\r\nimport Split from 'split.js';\r\n\r\nexport class CodeEditor {\r\n    constructor(editor, opts) {\r\n        this.editor = editor;\r\n        this.$ = editor.$;\r\n        this.pfx = editor.getConfig('stylePrefix');\r\n        this.opts = opts;\r\n        this.canvas = this.findWithinEditor(`.${this.pfx}cv-canvas`);\r\n        this.panelViews = opts.appendTo ? this.$(opts.appendTo) :\r\n            this.findWithinEditor(`.${this.pfx}pn-${opts.panelId}`);\r\n        this.isShowing = true;\r\n        this.monacoInstances = {};\r\n        this.monacoReady = false;\r\n        this.loadMonaco();\r\n    }\r\n\r\n    findPanel() {\r\n        const pn = this.editor.Panels;\r\n        const id = this.opts.panelId;\r\n        return pn.getPanel(id) || pn.addPanel({ id });\r\n    }\r\n\r\n    findWithinEditor(selector) {\r\n        return this.$(selector, this.editor.getEl());\r\n    }\r\n\r\n    loadMonaco() {\r\n        // Check if Monaco is already loaded\r\n        if (window.monaco) {\r\n            this.monacoReady = true;\r\n            return Promise.resolve();\r\n        }\r\n\r\n        // Check if Monaco is currently being loaded\r\n        if (window.monacoLoading) {\r\n            return window.monacoLoading;\r\n        }\r\n\r\n        // Create a global promise to prevent multiple loads\r\n        window.monacoLoading = new Promise((resolve, reject) => {\r\n            // Check if loader script is already present\r\n            if (document.querySelector('script[src*=\"vs/loader.min.js\"]')) {\r\n                // If script exists but Monaco isn't loaded yet, wait for it\r\n                const checkMonaco = () => {\r\n                    if (window.monaco) {\r\n                        this.configureMonaco();\r\n                        this.monacoReady = true;\r\n                        resolve();\r\n                    } else {\r\n                        setTimeout(checkMonaco, 100);\r\n                    }\r\n                };\r\n                checkMonaco();\r\n                return;\r\n            }\r\n\r\n            // Load Monaco Editor from CDN\r\n            const script = document.createElement('script');\r\n            script.src = 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.52.0/min/vs/loader.min.js';\r\n            script.onload = () => {\r\n                // Check if require is already configured\r\n                if (!window.require || !window.require.config) {\r\n                    console.error('Monaco loader failed to initialize require');\r\n                    reject(new Error('Monaco loader failed to initialize require'));\r\n                    return;\r\n                }\r\n\r\n                // Configure paths only if not already configured\r\n                if (!window.require.s || !window.require.s.contexts || !window.require.s.contexts._.config.paths.vs) {\r\n                    window.require.config({\r\n                        paths: {\r\n                            'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.52.0/min/vs'\r\n                        }\r\n                    });\r\n                }\r\n\r\n                window.require(['vs/editor/editor.main'], () => {\r\n                    this.configureMonaco();\r\n                    this.monacoReady = true;\r\n                    // console.log('Monaco Editor loaded successfully');\r\n                    resolve();\r\n                });\r\n            };\r\n            script.onerror = () => {\r\n                console.error('Failed to load Monaco Editor');\r\n                reject(new Error('Failed to load Monaco Editor'));\r\n            };\r\n            document.head.appendChild(script);\r\n        });\r\n\r\n        return window.monacoLoading;\r\n    }\r\n\r\n    configureMonaco() {\r\n        if (!window.monaco) return;\r\n\r\n        // Configure HTML language service\r\n        window.monaco.languages.html.htmlDefaults.setOptions({\r\n            format: {\r\n                tabSize: 2,\r\n                insertSpaces: true,\r\n                wrapLineLength: 120,\r\n                unformatted: 'default: \"a, abbr, acronym, b, bdo, big, br, button, cite, code, dfn, em, i, img, input, kbd, label, map, mark, meter, noscript, object, output, q, ruby, s, samp, select, small, span, strong, sub, sup, textarea, time, tt, u, var, wbr\"',\r\n                contentUnformatted: 'pre',\r\n                indentInnerHtml: false,\r\n                preserveNewLines: true,\r\n                maxPreserveNewLines: 2,\r\n                indentHandlebars: false,\r\n                endWithNewline: false,\r\n                extraLiners: 'head, body, /html',\r\n                wrapAttributes: 'auto'\r\n            }\r\n        });\r\n\r\n        // Configure CSS language service\r\n        window.monaco.languages.css.cssDefaults.setOptions({\r\n            format: {\r\n                insertSpaces: true,\r\n                tabSize: 2,\r\n                newlineBetweenSelectors: true,\r\n                newlineBetweenRules: true,\r\n                spaceAroundSelectorSeparator: true,\r\n                braceStyle: 'collapse',\r\n                maxPreserveNewLines: 2,\r\n                preserveNewLines: true\r\n            }\r\n        });\r\n    }\r\n\r\n    buildCodeEditor(type) {\r\n        const { editor, opts } = this;\r\n        \r\n        // Create unique container ID to prevent conflicts\r\n        const containerId = `monaco-editor-container-${type}-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\r\n        \r\n        const container = document.createElement('div');\r\n        container.style.width = '100%';\r\n        container.style.height = '100%';\r\n        container.className = `monaco-editor-container-${type}`;\r\n        container.id = containerId;\r\n        \r\n        const editorWrapper = {\r\n            container: container,\r\n            type: type,\r\n            getElement: () => container,\r\n            setContent: (content) => {\r\n                if (editorWrapper.editor) {\r\n                    editorWrapper.editor.setValue(content || '');\r\n                    // Auto-format the code after setting content\r\n                    setTimeout(() => {\r\n                        this.formatCodeAutomatically(type, editorWrapper.editor);\r\n                    }, 100);\r\n                } else {\r\n                    editorWrapper.pendingContent = content;\r\n                }\r\n            },\r\n            getContent: () => {\r\n                return editorWrapper.editor ? editorWrapper.editor.getValue() : (editorWrapper.pendingContent || '');\r\n            },\r\n            refresh: () => {\r\n                if (editorWrapper.editor) {\r\n                    editorWrapper.editor.layout();\r\n                }\r\n            },\r\n            dispose: () => {\r\n                if (editorWrapper.editor) {\r\n                    editorWrapper.editor.dispose();\r\n                    editorWrapper.editor = null;\r\n                }\r\n            },\r\n            editor: null,\r\n            pendingContent: ''\r\n        };\r\n\r\n        // Set initial loading message\r\n        container.innerHTML = `<div style=\"padding: 20px; color: #888; text-align: center; background: #1e1e1e; border: 1px solid #3c3c3c;\">Loading Editor...</div>`;\r\n        \r\n        // Store reference for later initialization\r\n        if (!this.editorWrappers) {\r\n            this.editorWrappers = {};\r\n        }\r\n        this.editorWrappers[type] = editorWrapper;\r\n\r\n        return editorWrapper;\r\n    }\r\n\r\n    createMonacoEditor(editorWrapper, type) {\r\n        if (!window.monaco) {\r\n            console.error('Monaco is not available');\r\n            return;\r\n        }\r\n\r\n        // Check if editor already exists for this wrapper\r\n        if (editorWrapper.editor) {\r\n            // console.log(`Monaco editor already exists for ${type}, skipping creation`);\r\n            return;\r\n        }\r\n\r\n        // Check if Monaco instance already exists for this type\r\n        if (this.monacoInstances[type]) {\r\n            console.log(`Monaco instance already exists for ${type}, disposing old instance`);\r\n            this.monacoInstances[type].dispose();\r\n            delete this.monacoInstances[type];\r\n        }\r\n\r\n        // console.log(`Creating Monaco editor for ${type}...`);\r\n        \r\n        // Clear loading message\r\n        editorWrapper.container.innerHTML = '';\r\n\r\n        try {\r\n            const monacoEditor = window.monaco.editor.create(editorWrapper.container, {\r\n                value: editorWrapper.pendingContent || '',\r\n                language: type === 'html' ? 'html' : 'css',\r\n                theme: 'vs-dark',\r\n                automaticLayout: true,\r\n                minimap: { enabled: false },\r\n                scrollBeyondLastLine: false,\r\n                fontSize: 14,\r\n                lineNumbers: 'on',\r\n                roundedSelection: false,\r\n                scrollbar: {\r\n                    vertical: 'auto',\r\n                    horizontal: 'auto'\r\n                },\r\n                wordWrap: 'on',\r\n                formatOnType: true,\r\n                formatOnPaste: true,\r\n                ...this.opts.codeViewOptions\r\n            });\r\n\r\n            // Add keyboard shortcut for formatting (Ctrl+Shift+F or Cmd+Shift+F)\r\n            monacoEditor.addAction({\r\n                id: `format-code-${type}`,\r\n                label: 'Format Code',\r\n                keybindings: [\r\n                    window.monaco.KeyMod.CtrlCmd | window.monaco.KeyMod.Shift | window.monaco.KeyCode.KeyF\r\n                ],\r\n                run: () => {\r\n                    this.formatCodeAutomatically(type, monacoEditor);\r\n                }\r\n            });\r\n\r\n            editorWrapper.editor = monacoEditor;\r\n            editorWrapper.pendingContent = '';\r\n\r\n            // Store the instance for later use\r\n            this.monacoInstances[type] = monacoEditor;\r\n            \r\n            // console.log(`Monaco editor created successfully for ${type}`);\r\n            \r\n            // Auto-format any pending content\r\n            if (editorWrapper.pendingContent && editorWrapper.pendingContent.trim()) {\r\n                setTimeout(() => {\r\n                    this.formatCodeAutomatically(type, monacoEditor);\r\n                }, 200);\r\n            }\r\n            \r\n            // Trigger layout after a short delay to ensure proper sizing\r\n            setTimeout(() => {\r\n                monacoEditor.layout();\r\n            }, 100);\r\n            \r\n        } catch (error) {\r\n            console.error(`Failed to create Monaco editor for ${type}:`, error);\r\n            // Fallback to textarea for this specific editor\r\n            this.createTextareaFallback(editorWrapper, type);\r\n        }\r\n    }\r\n\r\n    createTextareaFallback(editorWrapper, type) {\r\n        const textarea = document.createElement('textarea');\r\n        textarea.style.width = '100%';\r\n        textarea.style.height = '100%';\r\n        textarea.style.background = '#1e1e1e';\r\n        textarea.style.color = '#cccccc';\r\n        textarea.style.border = '1px solid #3c3c3c';\r\n        textarea.style.fontFamily = 'monospace';\r\n        textarea.style.fontSize = '14px';\r\n        textarea.style.resize = 'none';\r\n        textarea.style.outline = 'none';\r\n        textarea.value = editorWrapper.pendingContent || '';\r\n        \r\n        editorWrapper.container.innerHTML = '';\r\n        editorWrapper.container.appendChild(textarea);\r\n        \r\n        // Update wrapper methods\r\n        editorWrapper.setContent = (content) => {\r\n            textarea.value = content || '';\r\n        };\r\n        editorWrapper.getContent = () => textarea.value;\r\n        editorWrapper.refresh = () => {};\r\n    }\r\n\r\n    buildSection(type, codeViewer) {\r\n        const { $, pfx, opts } = this;\r\n        const section = $('<section></section>');\r\n        const btnText = type === 'html' ? opts.htmlBtnText : opts.cssBtnText;\r\n        const cleanCssBtn = (opts.cleanCssBtn && type === 'css') ?\r\n            `<button class=\"cp-delete-${type} ${pfx}btn-prim\">${opts.cleanCssBtnText}</button>` : '';\r\n        section.append($(`\r\n            <div class=\"codepanel-separator\">\r\n                <div class=\"codepanel-label\">${type}</div>\r\n                <div class=\"cp-btn-container\">\r\n                    <button class=\"cp-apply-${type} ${pfx}btn-prim\">${btnText}</button>\r\n                </div>\r\n            </div>`));\r\n        const codeViewerEl = codeViewer.getElement();\r\n        codeViewerEl.style.height = 'calc(100% - 30px)';\r\n        section.append(codeViewerEl);\r\n        this.codePanel.append(section);\r\n        return section.get(0);\r\n    }\r\n\r\n    buildCodePanel() {\r\n        const { $, editor } = this;\r\n        const panel = this.opts.panelId ? this.findPanel() : 0;\r\n        this.codePanel = $('<div></div>');\r\n        this.codePanel.addClass('code-panel');\r\n\r\n        this.htmlCodeEditor = this.buildCodeEditor('html');\r\n        this.cssCodeEditor = this.buildCodeEditor('css');\r\n\r\n        const sections = [this.buildSection('html', this.htmlCodeEditor), this.buildSection('css', this.cssCodeEditor)];\r\n\r\n        panel && !this.opts.appendTo &&\r\n            panel.set('appendContent', this.codePanel).trigger('change:appendContent');\r\n        this.opts.appendTo && $(this.opts.appendTo).append(this.codePanel);\r\n\r\n        this.codePanel.find('.cp-apply-html')\r\n            .on('click', this.updateHtml.bind(this));\r\n\r\n        this.codePanel.find('.cp-apply-css')\r\n            .on('click', this.updateCss.bind(this));\r\n\r\n        this.opts.cleanCssBtn && this.codePanel.find('.cp-delete-css')\r\n            .on('click', this.deleteSelectedCss.bind(this));\r\n\r\n        Split(sections, {\r\n            direction: 'vertical',\r\n            sizes: [50, 50],\r\n            minSize: 100,\r\n            gutterSize: 1,\r\n            onDragEnd: this.refreshEditors.bind(this),\r\n        });\r\n\r\n        editor.on('component:update', model => this.updateEditorContents());\r\n        editor.on('stop:preview', () => {\r\n            if (this.isShowing && !this.opts.preserveWidth) {\r\n                this.canvas.css('width', this.opts.openState.cv);\r\n            }\r\n        });\r\n\r\n        // Initialize Monaco editors after panel is built\r\n        this.initializeMonacoEditorsWhenReady();\r\n    }\r\n\r\n    initializeMonacoEditorsWhenReady() {\r\n        if (this.monacoReady && window.monaco) {\r\n            this.initializeMonacoEditors();\r\n        } else {\r\n            // Wait for Monaco to load\r\n            this.loadMonaco().then(() => {\r\n                this.initializeMonacoEditors();\r\n            }).catch(error => {\r\n                console.error('Failed to initialize Monaco editors:', error);\r\n                // Fallback to basic textarea\r\n                this.fallbackToTextarea();\r\n            });\r\n        }\r\n    }\r\n\r\n    initializeMonacoEditors() {\r\n        console.log('Initializing Monaco editors...');\r\n        \r\n        // Wait a bit for DOM to be ready\r\n        setTimeout(() => {\r\n            if (this.editorWrappers) {\r\n                Object.keys(this.editorWrappers).forEach(type => {\r\n                    const wrapper = this.editorWrappers[type];\r\n                    if (wrapper && wrapper.container.parentElement) {\r\n                        this.createMonacoEditor(wrapper, type);\r\n                    }\r\n                });\r\n            }\r\n        }, 100);\r\n    }\r\n\r\n    fallbackToTextarea() {\r\n        if (this.editorWrappers) {\r\n            Object.keys(this.editorWrappers).forEach(type => {\r\n                const wrapper = this.editorWrappers[type];\r\n                if (wrapper && wrapper.container) {\r\n                    const textarea = document.createElement('textarea');\r\n                    textarea.style.width = '100%';\r\n                    textarea.style.height = '100%';\r\n                    textarea.style.background = '#1e1e1e';\r\n                    textarea.style.color = '#cccccc';\r\n                    textarea.style.border = '1px solid #3c3c3c';\r\n                    textarea.style.fontFamily = 'monospace';\r\n                    textarea.style.fontSize = '14px';\r\n                    textarea.style.resize = 'none';\r\n                    textarea.style.outline = 'none';\r\n                    textarea.value = wrapper.pendingContent || '';\r\n                    \r\n                    wrapper.container.innerHTML = '';\r\n                    wrapper.container.appendChild(textarea);\r\n                    \r\n                    // Update wrapper methods\r\n                    wrapper.setContent = (content) => {\r\n                        textarea.value = content || '';\r\n                    };\r\n                    wrapper.getContent = () => textarea.value;\r\n                    wrapper.refresh = () => {};\r\n                }\r\n            });\r\n        }\r\n        this.updateEditorContents();\r\n    }\r\n\r\n    showCodePanel() {\r\n        this.isShowing = true;\r\n        this.codePanel.css('display', 'block');\r\n        \r\n        // Initialize Monaco editors if not already done\r\n        if (!this.monacoInstances.html && !this.monacoInstances.css) {\r\n            this.initializeMonacoEditorsWhenReady();\r\n        }\r\n        \r\n        this.updateEditorContents();\r\n        \r\n        // Auto-format existing content when showing the panel\r\n        setTimeout(() => {\r\n            if (this.monacoInstances.html && this.monacoInstances.html.getValue().trim()) {\r\n                this.formatCodeAutomatically('html', this.monacoInstances.html);\r\n            }\r\n            if (this.monacoInstances.css && this.monacoInstances.css.getValue().trim()) {\r\n                this.formatCodeAutomatically('css', this.monacoInstances.css);\r\n            }\r\n        }, 300);\r\n        \r\n        // make sure editor is aware of width change after the 300ms effect ends\r\n        setTimeout(this.refreshEditors.bind(this), 320);\r\n\r\n        if (this.opts.preserveWidth) return;\r\n\r\n        this.panelViews.css('width', this.opts.openState.pn);\r\n        this.canvas.css('width', this.opts.openState.cv);\r\n    }\r\n\r\n    hideCodePanel() {\r\n        if (this.codePanel) this.codePanel.css('display', 'none');\r\n        this.isShowing = false;\r\n\r\n        if (this.opts.preserveWidth) return;\r\n\r\n        this.panelViews.css('width', this.opts.closedState.pn);\r\n        this.canvas.css('width', this.opts.closedState.cv);\r\n    }\r\n\r\n    refreshEditors() {\r\n        this.htmlCodeEditor.refresh();\r\n        this.cssCodeEditor.refresh();\r\n    }\r\n\r\n    formatCodeAutomatically(type, monacoEditor) {\r\n        if (!monacoEditor) return;\r\n\r\n        try {\r\n            // Try Monaco's built-in formatting first\r\n            const action = monacoEditor.getAction('editor.action.formatDocument');\r\n            if (action) {\r\n                action.run().then(() => {\r\n                    // console.log(`Code auto-formatted successfully for ${type}`);\r\n                }).catch(error => {\r\n                    console.warn(`Monaco auto-formatting failed for ${type}, using fallback:`, error);\r\n                    this.fallbackFormat(type, monacoEditor);\r\n                });\r\n            } else {\r\n                // Use fallback if action not available\r\n                this.fallbackFormat(type, monacoEditor);\r\n            }\r\n        } catch (error) {\r\n            console.error(`Failed to auto-format ${type} code:`, error);\r\n            // Fallback to basic formatting if Monaco formatting fails\r\n            this.fallbackFormat(type, monacoEditor);\r\n        }\r\n    }\r\n\r\n    fallbackFormat(type, monacoEditor) {\r\n        const content = monacoEditor.getValue();\r\n        if (!content.trim()) return;\r\n\r\n        let formattedContent = '';\r\n        \r\n        if (type === 'html') {\r\n            formattedContent = this.formatHtml(content);\r\n        } else if (type === 'css') {\r\n            formattedContent = this.formatCss(content);\r\n        }\r\n\r\n        if (formattedContent && formattedContent !== content) {\r\n            monacoEditor.setValue(formattedContent);\r\n        }\r\n    }\r\n\r\n    formatHtml(html) {\r\n        try {\r\n            // Basic HTML formatting with better indentation\r\n            let formatted = html\r\n                .replace(/>\\s*</g, '><') // Remove whitespace between tags\r\n                .replace(/></g, '>\\n<')  // Add newlines between tags\r\n                .split('\\n')\r\n                .filter(line => line.trim())\r\n                .map((line, index, array) => {\r\n                    const trimmed = line.trim();\r\n                    if (!trimmed) return '';\r\n                    \r\n                    let indent = 0;\r\n                    \r\n                    // Calculate indentation level\r\n                    for (let i = 0; i < index; i++) {\r\n                        const prevLine = array[i].trim();\r\n                        if (!prevLine) continue;\r\n                        \r\n                        // Count opening tags (not self-closing)\r\n                        const openTags = (prevLine.match(/<[^\\/!][^>]*(?<!\\/\\s*)>/g) || []).length;\r\n                        // Count closing tags\r\n                        const closeTags = (prevLine.match(/<\\/[^>]*>/g) || []).length;\r\n                        // Count self-closing tags (shouldn't affect indentation)\r\n                        const selfClosingTags = (prevLine.match(/<[^>]*\\/>/g) || []).length;\r\n                        \r\n                        indent += (openTags - selfClosingTags) - closeTags;\r\n                    }\r\n                    \r\n                    // Adjust for current line if it's a closing tag\r\n                    if (trimmed.startsWith('</')) {\r\n                        indent = Math.max(0, indent - 1);\r\n                    }\r\n                    \r\n                    return '  '.repeat(Math.max(0, indent)) + trimmed;\r\n                })\r\n                .join('\\n');\r\n            \r\n            return formatted;\r\n        } catch (error) {\r\n            console.error('HTML formatting error:', error);\r\n            return html;\r\n        }\r\n    }\r\n\r\n    formatCss(css) {\r\n        try {\r\n            // Enhanced CSS formatting\r\n            let formatted = css\r\n                // Remove extra whitespace\r\n                .replace(/\\s+/g, ' ')\r\n                .trim()\r\n                // Format selectors and opening braces\r\n                .replace(/\\s*{\\s*/g, ' {\\n  ')\r\n                // Format properties\r\n                .replace(/;\\s*/g, ';\\n  ')\r\n                // Format closing braces\r\n                .replace(/\\s*}\\s*/g, '\\n}\\n\\n')\r\n                // Format comma-separated selectors\r\n                .replace(/,\\s*/g, ',\\n')\r\n                // Clean up multiple newlines\r\n                .replace(/\\n\\s*\\n\\s*\\n/g, '\\n\\n')\r\n                // Remove trailing spaces from properties\r\n                .replace(/\\s+;/g, ';')\r\n                // Clean up the last closing brace\r\n                .replace(/}\\n\\n$/, '}')\r\n                .trim();\r\n            \r\n            // Additional cleanup for nested rules or at-rules\r\n            formatted = formatted\r\n                .replace(/(@[^{]+{\\s*)/g, '$1\\n  ')\r\n                .replace(/(@media[^{]+{\\s*)/g, '$1\\n  ')\r\n                .replace(/(@keyframes[^{]+{\\s*)/g, '$1\\n  ');\r\n            \r\n            return formatted;\r\n        } catch (error) {\r\n            console.error('CSS formatting error:', error);\r\n            return css;\r\n        }\r\n    }\r\n\r\n    updateHtml(e) {\r\n        e?.preventDefault();\r\n        const { editor, component } = this;\r\n        let htmlCode = this.htmlCodeEditor.getContent().trim();\r\n        if (!htmlCode || htmlCode === this.previousHtmlCode) return;\r\n        this.previousHtmlCode = htmlCode;\r\n\r\n        let idStyles = '';\r\n        this.cssCodeEditor\r\n            .getContent()\r\n            .split('}\\n')\r\n            .filter((el) => Boolean(el.trim()))\r\n            .map((cssObjectRule) => {\r\n                if (!(/}$/.test(cssObjectRule))) {\r\n                    //* Have to check closing bracket existence for every rule cause it can be missed after split and add it if it doesnt match\r\n                    return `${cssObjectRule}}`;\r\n                }\r\n            })\r\n            .forEach(rule => {\r\n                if (/^#/.test(rule))\r\n                    idStyles += rule;\r\n            });\r\n\r\n        htmlCode += `<style>${idStyles}</style>`;\r\n\r\n        if (component.attributes.type === 'wrapper') {\r\n            editor.setComponents(htmlCode);\r\n        } else {\r\n            editor.select(component.replaceWith(htmlCode));\r\n        }\r\n        return htmlCode;\r\n    }\r\n\r\n    updateCss(e) {\r\n        e?.preventDefault();\r\n        const cssCode = this.cssCodeEditor.getContent().trim();\r\n        if (!cssCode || cssCode === this.previousCssCode) return;\r\n        this.previousCssCode = cssCode;\r\n        this.editor.Css.addRules(cssCode);\r\n        return cssCode;\r\n    }\r\n\r\n    deleteSelectedCss(e) {\r\n        e?.preventDefault();\r\n        const monacoEditor = this.monacoInstances.css;\r\n        if (!monacoEditor) return;\r\n        \r\n        const selection = monacoEditor.getSelection();\r\n        if (selection && !selection.isEmpty()) {\r\n            const selectedText = monacoEditor.getModel().getValueInRange(selection);\r\n            this.parseRemove(selectedText);\r\n            monacoEditor.executeEdits('', [{\r\n                range: selection,\r\n                text: ''\r\n            }]);\r\n        }\r\n    }\r\n\r\n    parseRemove(removeCss) {\r\n        return this.editor.Css.remove(this.getRules(this.editor.Parser.parseCss(removeCss)));\r\n    }\r\n\r\n    getRules(rules, opts = {}) {\r\n        const { editor } = this;\r\n        const sm = editor.Selectors;\r\n        return rules.map((rule) => {\r\n            const selector = sm.get(rule.selectors);\r\n            const { state, selectorsAdd } = rule;\r\n            const { atRuleType, atRuleParams } = opts;\r\n            return (\r\n                selector &&\r\n                editor.Css.get(selector, state, atRuleParams, {\r\n                    selectorsAdd,\r\n                    atRule: atRuleType,\r\n                })\r\n            );\r\n        });\r\n    }\r\n\r\n    updateEditorContents() {\r\n        if (!this.isShowing) return;\r\n\r\n        this.component = this.editor.getSelected();\r\n        if (this.component) {\r\n            const htmlContent = this.getComponentHtml(this.component);\r\n            const cssContent = this.editor.CodeManager.getCode(this.component, 'css', {\r\n                cssc: this.editor.Css\r\n            });\r\n            \r\n            // Set content without auto-formatting first to avoid double formatting\r\n            if (this.htmlCodeEditor.editor) {\r\n                this.htmlCodeEditor.editor.setValue(htmlContent || '');\r\n                if (htmlContent && htmlContent.trim()) {\r\n                    setTimeout(() => {\r\n                        this.formatCodeAutomatically('html', this.htmlCodeEditor.editor);\r\n                    }, 100);\r\n                }\r\n            } else {\r\n                this.htmlCodeEditor.pendingContent = htmlContent;\r\n            }\r\n            \r\n            if (this.cssCodeEditor.editor) {\r\n                this.cssCodeEditor.editor.setValue(cssContent || '');\r\n                if (cssContent && cssContent.trim()) {\r\n                    setTimeout(() => {\r\n                        this.formatCodeAutomatically('css', this.cssCodeEditor.editor);\r\n                    }, 150);\r\n                }\r\n            } else {\r\n                this.cssCodeEditor.pendingContent = cssContent;\r\n            }\r\n        }\r\n    }\r\n\r\n    getComponentHtml(component) {\r\n        const { pfx, opts } = this;\r\n        let result = '';\r\n        const componentEl = component.getEl();\r\n\r\n        !opts.clearData && componentEl.classList.remove(`${pfx}selected`);\r\n        const html = opts.clearData ? component.toHTML() :\r\n            (component.attributes.type === 'wrapper' ? componentEl.innerHTML : componentEl.outerHTML);\r\n        !opts.clearData && componentEl.classList.add(`${pfx}selected`);\r\n        result += html;\r\n\r\n        const js = opts.editJs ? component.getScriptString() : '';\r\n        result += js ? `<script>${js}</script>` : '';\r\n\r\n        return result;\r\n    }\r\n\r\n    dispose() {\r\n        // Clean up Monaco Editor instances\r\n        if (this.htmlCodeEditor && this.htmlCodeEditor.dispose) {\r\n            this.htmlCodeEditor.dispose();\r\n        }\r\n        if (this.cssCodeEditor && this.cssCodeEditor.dispose) {\r\n            this.cssCodeEditor.dispose();\r\n        }\r\n        if (this.monacoInstances.html) {\r\n            this.monacoInstances.html.dispose();\r\n        }\r\n        if (this.monacoInstances.css) {\r\n            this.monacoInstances.css.dispose();\r\n        }\r\n        \r\n        // Clear editor wrappers\r\n        if (this.editorWrappers) {\r\n            Object.values(this.editorWrappers).forEach(wrapper => {\r\n                if (wrapper && wrapper.dispose) {\r\n                    wrapper.dispose();\r\n                }\r\n            });\r\n            this.editorWrappers = {};\r\n        }\r\n        \r\n        // Clear instances\r\n        this.monacoInstances = {};\r\n        \r\n        // Clear code panel\r\n        if (this.codePanel) {\r\n            this.codePanel.remove();\r\n            this.codePanel = null;\r\n        }\r\n    }\r\n}\r\n","import { CodeEditor } from './code-editor';\r\nimport { openCodeStr, getObject, getConstuctor } from './consts';\r\n\r\nexport default (editor, opts) => {\r\n    const cm = editor.Commands;\r\n    let codeEditor = null;\r\n\r\n    cm.add(openCodeStr, {\r\n        run: editor => {\r\n            !codeEditor && (codeEditor = new CodeEditor(editor, opts)) && codeEditor.buildCodePanel();\r\n            codeEditor.showCodePanel();\r\n            // Expose CodeEditor instance to the editor object\r\n            editor.CodeEditor = codeEditor;\r\n        },\r\n        stop: editor => {\r\n            codeEditor && codeEditor.hideCodePanel();\r\n        },\r\n    });\r\n\r\n    cm.add(getObject, () => {\r\n        return codeEditor;\r\n    });\r\n\r\n    cm.add(getConstuctor, () => {\r\n        return CodeEditor;\r\n    });\r\n}","export const\r\n    openCodeStr = 'open-code',\r\n    getObject = 'code-editor-object',\r\n    getConstuctor = 'code-editor-constructor';","import commands from './commands';\r\n\r\nexport default (editor, opts = {}) => {\r\n    const options = {\r\n        ...{\r\n            //Panel to append the code editor\r\n            panelId: 'views-container',\r\n            //Append to element instead of views-container\r\n            appendTo: '',\r\n            //State when open\r\n            openState: {\r\n                cv: '65%',\r\n                pn: '35%'\r\n            },\r\n            //State when closed\r\n            closedState: {\r\n                cv: '85%',\r\n                pn: '15%'\r\n            },\r\n            //Code viewer options\r\n            codeViewOptions: {},\r\n            //Stop resizing openState and closedState\r\n            preserveWidth: false,\r\n            //Allow editing of javascript, set allowScripts to true for this to work\r\n            editJs: false,\r\n            //Remove component data eg data-gjs-type=\"...\"\r\n            clearData: false,\r\n            //Used to remove css from the Selector Manager\r\n            cleanCssBtn: true,\r\n            //Save HTML button text\r\n            htmlBtnText: 'Apply',\r\n            //Save CSS button text\r\n            cssBtnText: 'Apply',\r\n            //Clean CSS button text\r\n            cleanCssBtnText: 'Delete'\r\n        },\r\n        ...opts\r\n    };\r\n\r\n    // Load commands\r\n    commands(editor, options);\r\n};\r\n"],"sourceRoot":""}