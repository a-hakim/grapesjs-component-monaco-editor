<!DOCTYPE html>
<html>
<head>
    <title>GrapesJS Monaco Editor Plugin Test</title>
    <meta charset="utf-8">
    <script src="https://unpkg.com/grapesjs@0.21.10/dist/grapes.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/grapesjs@0.21.10/dist/css/grapes.min.css">
    <link rel="stylesheet" href="dist/grapesjs-component-code-editor.min.css">
</head>
<body>
    <div id="gjs">
        <div>
            <h1>Hello World</h1>
            <p>This is a test page for the Monaco Editor plugin</p>
        </div>
    </div>

    <script src="dist/grapesjs-component-code-editor.min.js"></script>
    <script>
        const editor = grapesjs.init({
            container: '#gjs',
            height: '100vh',
            width: 'auto',
            storageManager: false,
            panels: { defaults: [] },
            blockManager: {
                appendTo: '#blocks',
                blocks: [
                    {
                        id: 'section',
                        label: 'Section',
                        attributes: { class: 'gjs-block-section' },
                        content: `<section>
                            <h1>Insert title here</h1>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
                        </section>`,
                    },
                    {
                        id: 'text',
                        label: 'Text',
                        content: '<div data-gjs-type="text">Insert your text here</div>',
                    },
                    {
                        id: 'image',
                        label: 'Image',
                        select: true,
                        content: { type: 'image' },
                        activate: true,
                    }
                ]
            },
            plugins: [
                'grapesjs-component-code-editor'
            ],
            pluginsOpts: {
                'grapesjs-component-code-editor': {
                    // Plugin options
                    editJs: false,
                    clearData: false,
                    codeViewOptions: {
                        // Monaco Editor options
                        fontSize: 14,
                        wordWrap: 'on',
                        minimap: { enabled: false }
                    }
                }
            }
        });

        // Add panels for the plugin
        editor.Panels.addPanel({
            id: 'views',
            buttons: [
                {
                    id: 'open-code',
                    className: 'fa fa-file-code-o',
                    command: 'open-code',
                    togglable: 0,
                    tooltip: 'Open Code Editor'
                }
            ]
        });

        // Add command for opening code editor
        editor.Commands.add('open-code', {
            run: function(editor, sender) {
                console.log('Opening code editor...');
                editor.runCommand('open-code');
            }
        });

        // Debug: Log when editor is ready
        editor.on('load', () => {
            console.log('GrapesJS editor loaded');
        });

        // Auto-open code editor for testing
        setTimeout(() => {
            console.log('Auto-opening code editor...');
            editor.runCommand('open-code');
        }, 1000);
    </script>

    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }
        
        #gjs {
            border: 1px solid #ccc;
        }
        
        /* Monaco Editor improvements */
        .code-panel {
            background: #1e1e1e;
        }
        
        .code-panel .monaco-editor {
            border: 1px solid #3c3c3c;
        }
        
        .codepanel-label {
            color: #cccccc !important;
        }
        
        .gjs-pn-views-container {
            background: #2d2d30;
        }
    </style>
</body>
</html>
